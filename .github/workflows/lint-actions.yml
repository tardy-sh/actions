name: Lint GitHub Actions workflows and actions
on: [push, pull_request]

jobs:
  actionlint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Download actionlint
        id: get_actionlint
        run: bash <(curl https://raw.githubusercontent.com/rhysd/actionlint/main/scripts/download-actionlint.bash)
        shell: bash
      - name: Check workflow files
        run: ${{ steps.get_actionlint.outputs.executable }} -color
        shell: bash
      - name: Find and check action.yml files
        run: |
          # Find all action.yml files
          ACTION_FILES=$(find . -name "action.yml" -type f)

          if [ -n "$ACTION_FILES" ]; then
            echo "Found action.yml files:"
            echo "$ACTION_FILES"
            echo ""
            echo "Linting action files..."
            echo "$ACTION_FILES" | xargs ${{ steps.get_actionlint.outputs.executable }} -color
          else
            echo "No action.yml files found"
          fi
        shell: bash
